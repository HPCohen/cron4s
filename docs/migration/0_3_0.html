<html><head><title>Cron4s: Migrating From 0.2.x to 0.3.0</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Antonio Alonso Dominguez" /><meta name="description" content="Scala CRON Parser" /><meta name="og:image" content="/cron4s/img/poster.png" /><meta name="og:title" content="Cron4s: Migrating From 0.2.x to 0.3.0" /><meta name="og:site_name" content="Cron4s" /><meta name="og:url" content="https://alonsodomin.github.io/cron4s" /><meta name="og:type" content="website" /><meta name="og:description" content="Scala CRON Parser" /><link rel="icon" type="image/png" href="/cron4s/img/favicon.png" /><meta name="twitter:title" content="Cron4s: Migrating From 0.2.x to 0.3.0" /><meta name="twitter:image" content="https://alonsodomin.github.io/cron4simg/poster.png" /><meta name="twitter:description" content="Scala CRON Parser" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/cron4s/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/cron4s/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/cron4s/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/cron4s/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/cron4s/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/cron4s/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/cron4s/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/cron4s/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/cron4s/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/cron4s/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/cron4s/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/cron4s/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/cron4s/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/cron4s/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/cron4s/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/cron4s/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/cron4s/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/cron4s/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/cron4s/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/cron4s/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/cron4s/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/cron4s/css/style.css" /><link rel="stylesheet" href="/cron4s/css/palette.css" /><link rel="stylesheet" href="/cron4s/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/cron4s/" class="brand"><div class="brand-wrapper"><span>Cron4s</span></div></a></li> <li><a href="/cron4s/docs/index.html" class="">First steps</a></li> <li><a href="/cron4s/docs/whats_new.html" class="">What's New?</a></li> <li><a href="/cron4s/docs/time_usage.html" class="">Working with Time</a> <ul class="sub_section"> <li><a href="/cron4s/docs/time_usage/matching.html" class="">Matching</a></li> <li><a href="/cron4s/docs/time_usage/forward_backwards.html" class="">Forwards & Backwards</a></li></ul></li> <li><a href="/cron4s/docs/builtin_libs.html" class="">Built-in libs</a></li> <li><a href="/cron4s/docs/extensions.html" class="">Extensions</a></li> <li><a href="/cron4s/docs/custom_datetime.html" class="">Custom DateTime</a></li> <li><a href="/cron4s/api/index.html" class="">API Docs</a></li> <li><a href="/cron4s/" class="">Migration Guides</a> <ul class="sub_section"> <li><a href="/cron4s/docs/migration/0_4_0.html" class="">0.3.x -> 0.4.x</a></li> <li><a href="/cron4s/docs/migration/0_3_0.html" class="">0.2.x -> 0.3.0</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/alonsodomin/cron4s"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/alonsodomin/cron4s"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Cron4s Scala CRON Parser');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Cron4s Scala CRON Parser');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="alonsodomin" data-github-repo="cron4s"><div class="content-wrapper"><section><h2 id="migrating-from-02x-to-030">Migrating From 0.2.x to 0.3.0</h2>

<p>There are several breaking changes in 0.3.0 when coming from the 0.2.x releases. This attempts to list the mayor 
changes needed to do in user code to be able to compile it with the new version.</p>

<h3 id="class-name-changes">Class name changes</h3>

<ul>
  <li>All expression nodes (<code class="highlighter-rouge">Expr</code> suffixed classes at <code class="highlighter-rouge">cron4s.expr</code> package) have been renamed with a <code class="highlighter-rouge">Node</code> suffix instead.</li>
  <li><code class="highlighter-rouge">cron4s.expr.AnyExpr</code> has been renamed to <code class="highlighter-rouge">cron4s.expr.EachNode</code>. The new name reflects better the semantics of the <code class="highlighter-rouge">*</code> inside a CRON expression.</li>
  <li><code class="highlighter-rouge">cron4s.types</code> package has been renamed to <code class="highlighter-rouge">cron4s.base</code></li>
  <li><code class="highlighter-rouge">cron4s.types.HasCronField</code> has been renamed to <code class="highlighter-rouge">cron4s.base.Enumerated</code> and itâ€™s no longer higher kinded.</li>
  <li><code class="highlighter-rouge">cron4s.types.IsFieldExpr</code> has been renamed to <code class="highlighter-rouge">cron4s.expr.FieldExpr</code>.</li>
  <li><code class="highlighter-rouge">cron4s.ext.DateTimeAdapter</code> has been renamed to <code class="highlighter-rouge">cron4s.datetime.IsDateTime</code>.</li>
</ul>

<h3 id="public-api-operations">Public API operations</h3>

<h4 id="errors">Errors</h4>

<p>The type <code class="highlighter-rouge">cron4s.ParseError</code> that used to be returned from the <code class="highlighter-rouge">Cron("...")</code> factory method has been replaced by a sealed
class family. The old type was exposing some model objects from the internal parser implementation whilst the new one
offer a cleaner foundation.</p>

<p>The new error types are meant to make user easy to distinguish if a given error was caused by a problem during parsing
or due to validation constrains.</p>

<h4 id="datetime-operations">DateTime operations</h4>

<p>CRON operations on DateTime representations have been unified for the three types of CRON expressions supported (full,
date only, time only). The built-in library support has been moved underneath the package <code class="highlighter-rouge">cron4s.lib</code>. This means that,
if wanting to use the Java 8 time support, the user will need these imports:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">java.time._</span>
<span class="k">import</span> <span class="nn">cron4s._</span>
<span class="k">import</span> <span class="nn">cron4s.lib.javatime._</span>
</code></pre></div></div>

<h5 id="individual-fields">Individual fields</h5>

<p>The DateTime API provided by individual expression fields has suffered a minor change to provide collisions with other
operations also available at the field level. For example, given the following inputs:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="nc">Right</span><span class="o">(</span><span class="n">cron</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Cron</span><span class="o">(</span><span class="s">"10-35 2,4,6 * ? * *"</span><span class="o">)</span>
<span class="n">cron</span><span class="k">:</span> <span class="kt">cron4s.CronExpr</span> <span class="o">=</span> <span class="mi">10</span><span class="o">-</span><span class="mi">35</span> <span class="mi">2</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">6</span> <span class="o">*</span> <span class="o">?</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">dateTime</span> <span class="k">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="n">of</span><span class="o">(</span><span class="mi">2016</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">9</span><span class="o">)</span>
<span class="n">dateTime</span><span class="k">:</span> <span class="kt">java.time.LocalDateTime</span> <span class="o">=</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="k">:</span><span class="err">04</span><span class="kt">:</span><span class="err">09</span>
</code></pre></div></div>

<p>There were cases in which users could find a compilation error when using the operations <code class="highlighter-rouge">next</code>, <code class="highlighter-rouge">prev</code> and <code class="highlighter-rouge">step</code> in
individual field expressions when used with DateTime objects. This was due to the existence of operations with the
same names that take an <code class="highlighter-rouge">Int</code> as their parameter, leading to an overloaded method situation in which sometimes the
compiler refused to resolve the implicit that enable to perform such operation in the DateTime object:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">cron</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">next</span><span class="o">(</span><span class="n">dateTime</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">24</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">java.time.LocalDateTime</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">Int</span>
       <span class="n">cron</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">next</span><span class="o">(</span><span class="n">dateTime</span><span class="o">)</span>
                         <span class="o">^</span>
</code></pre></div></div>

<p>To solve this problem the methods that operate on DateTime objects have been renamed including the <code class="highlighter-rouge">In</code> suffix:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">cron</span><span class="o">.</span><span class="n">seconds</span><span class="o">.</span><span class="n">nextIn</span><span class="o">(</span><span class="n">dateTime</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">java.time.LocalDateTime</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="k">:</span><span class="err">04</span><span class="kt">:</span><span class="err">10</span><span class="o">)</span>
</code></pre></div></div>

<p>This aligns them with the previously existent <code class="highlighter-rouge">matchesIn</code> method.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/cron4s/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'alonsodomin/cron4s'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/cron4s/js/main.js"></script></body></html>